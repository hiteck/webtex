<!-- Copyright 2014 Peter Williams and collaborators
     Licensed under the MIT license. See LICENSE.md for details -->

<!DOCTYPE html>

<html>
  <head>
    <title>Webtex Testbed</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="chrome/style.css">
    <style type="text/css">
      article {
        width: 700px;
        margin: 0px auto;
      }
    </style>
  </head>

  <body>
    <article class="webtex" id="webtex"></article>

    <script type="text/javascript" src="build/pdfjs/web/compatibility.js"></script>
    <script type="text/javascript" src="build/pdfjs/build/pdf.js"></script>

    <script type="text/javascript" src="build/browser-master-webtex.js"></script>
    <script type="text/javascript">
'use strict';

// XXX
var glyphurl = 'build/glyph-encoding.json';
var req = new XMLHttpRequest ();
req.open ('GET', glyphurl, true);
req.onload = function () {
    Webtex.parse_glyph_encoding_info (JSON.parse (req.responseText)); // errors!!!!!

    var targdiv = document.getElementById ('webtex');
    var worker_url = 'build/worker-webtex.js';
    var jsonurl = '../' + window.location.search.slice (1); // note: relative to *worker's* URL
    console.log ('loading ' + jsonurl + ' from worker ' + worker_url);

    var dr = new Webtex.DOMRenderer (worker_url, targdiv);
    dr.launch_feed_pre_parsed ({
        jsonurl: jsonurl,
    });
};
req.send (null);
</script>
  </body>
</html>
